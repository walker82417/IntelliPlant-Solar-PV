<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Machine Detail - Industrial Monitoring Web App</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom Styles -->
    <style>
        /* Dark theme styles - Full Dark Version */
        .brand-dark {
            background-color: #020617;
            background-image: 
                radial-gradient(at 20% 80%, #0f172a 0px, transparent 50%),
                radial-gradient(at 80% 20%, #0f172a 0px, transparent 50%),
                radial-gradient(at 40% 40%, #1e3a8a 0px, transparent 50%);
        }
        
        .text-on-dark {
            color: #f1f5f9;
        }
        
        .text-secondary-on-dark {
            color: #cbd5e1;
        }
        
        .card-on-dark {
            background-color: #0f172a;
            border: 1px solid #1e293b;
            backdrop-filter: blur(10px);
        }
        
        .nav-link-dark {
            color: #cbd5e1;
            transition: color 0.3s ease;
        }
        
        .nav-link-dark:hover {
            color: #f1f5f9;
        }
        
        .nav-link-dark.active {
            color: #3b82f6;
        }
        
        /* Chart container */
        .chart-container {
            position: relative;
            height: 200px;
            width: 100%;
        }
    </style>
</head>
<body class="brand-dark min-h-screen">
    <div id="root"></div>
    <script type="text/javascript">
        // Mock Data
        const mockMachines = [
            { id: 1, name: "CNC Machine A", status: "warning", location: "Factory Floor 1", lastMaintenance: "2023-05-15", type: "cnc" },
            { id: 2, name: "Hydraulic Press B", status: "normal", location: "Factory Floor 1", lastMaintenance: "2023-06-20", type: "press" },
            { id: 3, name: "Assembly Line C", status: "critical", location: "Factory Floor 2", lastMaintenance: "2023-04-10", type: "assembly" },
            { id: 4, name: "Packaging Machine D", status: "normal", location: "Factory Floor 2", lastMaintenance: "2023-06-18", type: "packaging" },
            { id: 5, name: "Welding Robot E", status: "warning", location: "Factory Floor 3", lastMaintenance: "2023-05-28", type: "robot" },
            { id: 6, name: "Conveyor Belt F", status: "normal", location: "Factory Floor 3", lastMaintenance: "2023-06-22", type: "conveyor" }
        ];
        
        // Get machine ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const machineId = urlParams.get('id');
        
        // Utility function to get machine by ID
        const getMachineById = (id) => {
            return mockMachines.find(machine => machine.id === parseInt(id));
        };
    </script>
    <script type="text/babel">
        // Navigation Bar Component
        const NavBar = () => {
            const navLinks = [
                { name: "Home", path: "index.html" },
                { name: "Dashboard", path: "dashboard.html" },
                { name: "Analytics", path: "Analytics.html" },
                { name: "Alerts", path: "Alerts.html" },
                { name: "AI Chat", path: "AI Chat.html" },
                { name: "Settings", path: "Settings.html" }
            ];
            
            // Get current page to highlight active link
            const getCurrentPage = () => {
                const path = window.location.pathname;
                const filename = path.substring(path.lastIndexOf('/') + 1);
                return filename === '' ? 'index.html' : filename;
            };
            
            const currentPage = getCurrentPage();
            
            return (
                <nav className="sticky top-0 z-50 bg-slate-950/90 backdrop-blur-md shadow-lg">
                    <div className="container mx-auto px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center space-x-10">
                            <div className="flex items-center">
                                <i data-lucide="activity" className="w-8 h-8 text-blue-500 mr-2"></i>
                                <span className="text-xl font-bold text-on-dark">Industrial Chatbot</span>
                            </div>
                            
                            <div className="hidden md:flex space-x-8 relative">
                                {navLinks.map((link) => (
                                    <a 
                                        key={link.name}
                                        href={link.path}
                                        className={`nav-link nav-link-dark px-1 py-2 ${currentPage === link.path ? 'active' : ''}`}
                                    >
                                        {link.name}
                                    </a>
                                ))}
                            </div>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                            <a 
                                href="login.html"
                                className="text-secondary-on-dark hover:text-on-dark transition-colors"
                            >
                                Sign In
                            </a>
                            <a 
                                href="signup.html"
                                className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"
                            >
                                Sign Up
                            </a>
                        </div>
                    </div>
                </nav>
            );
        };

        // Machine Detail Component
        const MachineDetail = () => {
            const machine = getMachineById(machineId);
            const [temperatureData, setTemperatureData] = React.useState([]);
            const [vibrationData, setVibrationData] = React.useState([]);
            const [speedData, setSpeedData] = React.useState([]);
            const [currentData, setCurrentData] = React.useState([]);
            const [timeLabels, setTimeLabels] = React.useState([]);
            
            React.useEffect(() => {
                // Initialize Lucide icons
                lucide.createIcons();
                
                // Initialize charts
                let tempChart, vibChart, speedChart, currentChart;
                
                const initCharts = () => {
                    // Generate initial data
                    const now = new Date();
                    const labels = [];
                    const tempValues = [];
                    const vibValues = [];
                    const speedValues = [];
                    const currentValues = [];
                    
                    // Generate 60 data points (1 minute of data)
                    for (let i = 59; i >= 0; i--) {
                        const time = new Date(now - i * 1000);
                        labels.push(time.toLocaleTimeString());
                        
                        // Generate realistic values based on machine type
                        let baseTemp, baseVib, baseSpeed, baseCurrent;
                        
                        switch(machine.type) {
                            case 'cnc':
                                baseTemp = 70; baseVib = 3.5; baseSpeed = 1200; baseCurrent = 18;
                                break;
                            case 'press':
                                baseTemp = 65; baseVib = 2.8; baseSpeed = 30; baseCurrent = 25;
                                break;
                            case 'assembly':
                                baseTemp = 75; baseVib = 4.2; baseSpeed = 60; baseCurrent = 15;
                                break;
                            case 'packaging':
                                baseTemp = 60; baseVib = 2.0; baseSpeed = 100; baseCurrent = 12;
                                break;
                            case 'robot':
                                baseTemp = 68; baseVib = 3.8; baseSpeed = 80; baseCurrent = 20;
                                break;
                            case 'conveyor':
                                baseTemp = 55; baseVib = 1.5; baseSpeed = 40; baseCurrent = 10;
                                break;
                            default:
                                baseTemp = 65; baseVib = 2.5; baseSpeed = 50; baseCurrent = 15;
                        }
                        
                        // Add some random variation
                        tempValues.push(baseTemp + (Math.random() - 0.5) * 10);
                        vibValues.push(baseVib + (Math.random() - 0.5) * 2);
                        speedValues.push(baseSpeed + (Math.random() - 0.5) * 20);
                        currentValues.push(baseCurrent + (Math.random() - 0.5) * 5);
                    }
                    
                    setTimeLabels(labels);
                    setTemperatureData(tempValues);
                    setVibrationData(vibValues);
                    setSpeedData(speedValues);
                    setCurrentData(currentValues);
                    
                    // Temperature Chart
                    const tempCtx = document.getElementById('tempChart').getContext('2d');
                    tempChart = new Chart(tempCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Temperature (°F)',
                                data: tempValues,
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#cbd5e1'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#94a3b8',
                                        maxRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 10
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                },
                                y: {
                                    ticks: {
                                        color: '#94a3b8'
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                    
                    // Vibration Chart
                    const vibCtx = document.getElementById('vibChart').getContext('2d');
                    vibChart = new Chart(vibCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Vibration (mm/s)',
                                data: vibValues,
                                borderColor: '#eab308',
                                backgroundColor: 'rgba(234, 179, 8, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#cbd5e1'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#94a3b8',
                                        maxRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 10
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                },
                                y: {
                                    ticks: {
                                        color: '#94a3b8'
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                    
                    // Speed Chart
                    const speedCtx = document.getElementById('speedChart').getContext('2d');
                    speedChart = new Chart(speedCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Speed (RPM)',
                                data: speedValues,
                                borderColor: '#22c55e',
                                backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#cbd5e1'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#94a3b8',
                                        maxRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 10
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                },
                                y: {
                                    ticks: {
                                        color: '#94a3b8'
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                    
                    // Current Chart
                    const currentCtx = document.getElementById('currentChart').getContext('2d');
                    currentChart = new Chart(currentCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Current (A)',
                                data: currentValues,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#cbd5e1'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#94a3b8',
                                        maxRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 10
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                },
                                y: {
                                    ticks: {
                                        color: '#94a3b8'
                                    },
                                    grid: {
                                        color: 'rgba(148, 163, 184, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                    
                    return { tempChart, vibChart, speedChart, currentChart };
                };
                
                const charts = initCharts();
                
                // Update charts every second
                const interval = setInterval(() => {
                    const now = new Date();
                    const newTime = now.toLocaleTimeString();
                    
                    // Generate new values based on machine type
                    let baseTemp, baseVib, baseSpeed, baseCurrent;
                    
                    switch(machine.type) {
                        case 'cnc':
                            baseTemp = 70; baseVib = 3.5; baseSpeed = 1200; baseCurrent = 18;
                            break;
                        case 'press':
                            baseTemp = 65; baseVib = 2.8; baseSpeed = 30; baseCurrent = 25;
                            break;
                        case 'assembly':
                            baseTemp = 75; baseVib = 4.2; baseSpeed = 60; baseCurrent = 15;
                            break;
                        case 'packaging':
                            baseTemp = 60; baseVib = 2.0; baseSpeed = 100; baseCurrent = 12;
                            break;
                        case 'robot':
                            baseTemp = 68; baseVib = 3.8; baseSpeed = 80; baseCurrent = 20;
                            break;
                        case 'conveyor':
                            baseTemp = 55; baseVib = 1.5; baseSpeed = 40; baseCurrent = 10;
                            break;
                        default:
                            baseTemp = 65; baseVib = 2.5; baseSpeed = 50; baseCurrent = 15;
                    }
                    
                    // Add some random variation
                    const newTemp = baseTemp + (Math.random() - 0.5) * 10;
                    const newVib = baseVib + (Math.random() - 0.5) * 2;
                    const newSpeed = baseSpeed + (Math.random() - 0.5) * 20;
                    const newCurrent = baseCurrent + (Math.random() - 0.5) * 5;
                    
                    // Update data arrays
                    const newLabels = [...timeLabels.slice(1), newTime];
                    const newTempData = [...temperatureData.slice(1), newTemp];
                    const newVibData = [...vibrationData.slice(1), newVib];
                    const newSpeedData = [...speedData.slice(1), newSpeed];
                    const newCurrentData = [...currentData.slice(1), newCurrent];
                    
                    setTimeLabels(newLabels);
                    setTemperatureData(newTempData);
                    setVibrationData(newVibData);
                    setSpeedData(newSpeedData);
                    setCurrentData(newCurrentData);
                    
                    // Update charts
                    charts.tempChart.data.labels = newLabels;
                    charts.tempChart.data.datasets[0].data = newTempData;
                    charts.tempChart.update('none');
                    
                    charts.vibChart.data.labels = newLabels;
                    charts.vibChart.data.datasets[0].data = newVibData;
                    charts.vibChart.update('none');
                    
                    charts.speedChart.data.labels = newLabels;
                    charts.speedChart.data.datasets[0].data = newSpeedData;
                    charts.speedChart.update('none');
                    
                    charts.currentChart.data.labels = newLabels;
                    charts.currentChart.data.datasets[0].data = newCurrentData;
                    charts.currentChart.update('none');
                }, 1000);
                
                // Cleanup on unmount
                return () => {
                    clearInterval(interval);
                    if (charts.tempChart) charts.tempChart.destroy();
                    if (charts.vibChart) charts.vibChart.destroy();
                    if (charts.speedChart) charts.speedChart.destroy();
                    if (charts.currentChart) charts.currentChart.destroy();
                };
            }, [machineId]);
            
            if (!machine) {
                return (
                    <div className="p-8">
                        <NavBar />
                        <div className="mt-16">
                            <h1 className="text-2xl font-bold text-on-dark mb-4">Machine Not Found</h1>
                            <p className="text-secondary-on-dark">The requested machine does not exist.</p>
                            <button 
                                className="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"
                                onClick={() => window.location.href = "dashboard.html"}
                            >
                                Back to Dashboard
                            </button>
                        </div>
                    </div>
                );
            }
            
            const getStatusColor = (status) => {
                switch (status) {
                    case 'critical': return 'text-red-600 bg-red-100';
                    case 'warning': return 'text-yellow-600 bg-yellow-100';
                    default: return 'text-green-600 bg-green-100';
                }
            };
            
            const getStatusText = (status) => {
                switch (status) {
                    case 'critical': return 'Critical';
                    case 'warning': return 'Warning';
                    default: return 'Normal';
                }
            };
            
            return (
                <div>
                    <NavBar />
                    <div className="p-8">
                        <div className="mb-8">
                            <div className="flex justify-between items-start">
                                <div>
                                    <button 
                                        className="flex items-center text-blue-400 hover:text-blue-300 mb-4"
                                        onClick={() => window.location.href = "dashboard.html"}
                                    >
                                        <i data-lucide="arrow-left" className="w-4 h-4 mr-1"></i>
                                        Back to Dashboard
                                    </button>
                                    <h1 className="text-2xl font-bold text-on-dark mb-2">{machine.name}</h1>
                                    <p className="text-secondary-on-dark">{machine.location}</p>
                                </div>
                                <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(machine.status)}`}>
                                    {getStatusText(machine.status)}
                                </span>
                            </div>
                        </div>
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div className="card-on-dark rounded-xl shadow-md p-6">
                                <h3 className="text-lg font-semibold text-on-dark mb-4">Temperature</h3>
                                <div className="chart-container">
                                    <canvas id="tempChart"></canvas>
                                </div>
                                <div className="mt-4 text-center">
                                    <span className="text-2xl font-bold text-on-dark">
                                        {temperatureData.length > 0 ? temperatureData[temperatureData.length - 1].toFixed(1) : 'Loading...'} °F
                                    </span>
                                </div>
                            </div>
                            <div className="card-on-dark rounded-xl shadow-md p-6">
                                <h3 className="text-lg font-semibold text-on-dark mb-4">Vibration</h3>
                                <div className="chart-container">
                                    <canvas id="vibChart"></canvas>
                                </div>
                                <div className="mt-4 text-center">
                                    <span className="text-2xl font-bold text-on-dark">
                                        {vibrationData.length > 0 ? vibrationData[vibrationData.length - 1].toFixed(1) : 'Loading...'} mm/s
                                    </span>
                                </div>
                            </div>
                            <div className="card-on-dark rounded-xl shadow-md p-6">
                                <h3 className="text-lg font-semibold text-on-dark mb-4">Speed</h3>
                                <div className="chart-container">
                                    <canvas id="speedChart"></canvas>
                                </div>
                                <div className="mt-4 text-center">
                                    <span className="text-2xl font-bold text-on-dark">
                                        {speedData.length > 0 ? speedData[speedData.length - 1].toFixed(0) : 'Loading...'} RPM
                                    </span>
                                </div>
                            </div>
                            <div className="card-on-dark rounded-xl shadow-md p-6">
                                <h3 className="text-lg font-semibold text-on-dark mb-4">Current</h3>
                                <div className="chart-container">
                                    <canvas id="currentChart"></canvas>
                                </div>
                                <div className="mt-4 text-center">
                                    <span className="text-2xl font-bold text-on-dark">
                                        {currentData.length > 0 ? currentData[currentData.length - 1].toFixed(1) : 'Loading...'} A
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div className="card-on-dark rounded-xl shadow-md p-6">
                            <h3 className="text-lg font-semibold text-on-dark mb-4">Maintenance Information</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <p className="text-secondary-on-dark">Last Maintenance</p>
                                    <p className="font-medium text-on-dark">{machine.lastMaintenance}</p>
                                </div>
                                <div>
                                    <p className="text-secondary-on-dark">Next Scheduled Maintenance</p>
                                    <p className="font-medium text-on-dark">2023-07-15</p>
                                </div>
                                <div>
                                    <p className="text-secondary-on-dark">Total Operating Hours</p>
                                    <p className="font-medium text-on-dark">4,285 hours</p>
                                </div>
                                <div>
                                    <p className="text-secondary-on-dark">Efficiency Rating</p>
                                    <p className="font-medium text-on-dark">92%</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            return <MachineDetail />;
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>